---
title: "Facteurs de Risque du TDAH chez les Enfants Tunisiens"
subtitle: "Analyse des Donn√©es MICS6 Tunisie 2023"
author: "Asma BELKAHLA"
date: "`r Sys.Date()`"
format:
  html:
    toc: true
    toc-depth: 3
    toc-location: left
    number-sections: true
    code-fold: true
    code-tools: true
    code-summary: "üìä Voir le code R"
    theme: cosmo
    highlight-style: github
    fig-width: 10
    fig-height: 7
    embed-resources: true
  pdf:
    toc: true
    number-sections: true
    colorlinks: true
    papersize: a4
    geometry: margin=2.5cm
engine: knitr
filters:
  - webr
webr:
  packages: ['ggplot2', 'dplyr']
execute:
  echo: false
  warning: false
  message: false
  cache: false
---

```{r setup}
#| include: false

# Charger les packages
library(tidyverse)
library(knitr)
library(kableExtra)
library(patchwork)
library(scales)

# Options globales
options(scipen = 999)
knitr::opts_chunk$set(
  fig.align = "center",
  dpi = 300
)

# D√©finir le r√©pertoire du projet
project_root <- getwd()

# Charger les donn√©es
load(file.path(project_root, "data", "processed", "03_features.RData"))
load(file.path(project_root, "data", "processed", "04_descriptive.RData"))
load(file.path(project_root, "data", "processed", "05_risk_score.RData"))
load(file.path(project_root, "data", "processed", "06_models.RData"))

cat("‚úÖ Donn√©es charg√©es avec succ√®s !\n")
cat("üìä √âchantillon :", nrow(dataset_score), "enfants\n")
```

# R√©sum√© Ex√©cutif {.unnumbered}

Cette √©tude analyse les facteurs de risque associ√©s au Trouble D√©ficitaire de l'Attention avec ou sans Hyperactivit√© (TDAH) chez les enfants tunisiens √¢g√©s de 0 √† 17 ans, en utilisant les donn√©es de l'enqu√™te MICS6 (Multiple Indicator Cluster Survey) r√©alis√©e en Tunisie en 2023.

## Objectifs principaux

1. Identifier les facteurs de risque socio-d√©mographiques, p√©rinataux et socio-√©conomiques associ√©s au TDAH
2. D√©velopper un score de risque th√©orique bas√© sur la litt√©rature scientifique
3. Quantifier l'association entre ces facteurs et le risque de TDAH
4. Identifier les populations vuln√©rables n√©cessitant une attention particuli√®re

## Principaux r√©sultats

- **√âchantillon analys√©** : `r format(nrow(dataset_score), big.mark=" ")` enfants vivants √¢g√©s de 0 √† 17 ans
- **Score de risque moyen** : `r round(mean(dataset_score$score_tdah), 1)` / 100 (ET = `r round(sd(dataset_score$score_tdah), 1)`)
- **Pr√©valence du risque √©lev√©** : `r round(mean(dataset_score$risque_tdah_eleve) * 100, 1)`% des enfants (score ‚â• 40)
- **Facteurs de risque majeurs identifi√©s** :
  - Pauvret√© (quintiles 1-2) : OR significatifs
  - Faible √©ducation maternelle : OR significatifs
  - Milieu rural : OR significatifs

# Introduction

## Contexte scientifique

Le Trouble D√©ficitaire de l'Attention avec ou sans Hyperactivit√© (TDAH) est l'un des troubles neurod√©veloppementaux les plus fr√©quents de l'enfance, affectant environ 5 √† 7% des enfants dans le monde. Le TDAH se caract√©rise par des sympt√¥mes d'inattention, d'hyperactivit√© et d'impulsivit√© qui interf√®rent avec le fonctionnement quotidien et le d√©veloppement de l'enfant.

### √âtiologie multifactorielle

L'√©tiologie du TDAH est complexe et multifactorielle, impliquant :

- **Facteurs g√©n√©tiques** : H√©ritabilit√© estim√©e √† 70-80%
- **Facteurs environnementaux** : Exposition pr√©natale, complications obst√©tricales
- **Facteurs socio-√©conomiques** : Pauvret√©, stress familial, faible √©ducation parentale
- **Facteurs p√©rinataux** : √Çge maternel extr√™me, pr√©maturit√©, faible poids de naissance

## Probl√©matique tunisienne

En Tunisie, peu d'√©tudes ont explor√© syst√©matiquement les facteurs de risque du TDAH au niveau populationnel. Cette √©tude utilise les donn√©es de l'enqu√™te MICS6, une enqu√™te nationale repr√©sentative, pour :

1. Identifier les facteurs de risque modifiables
2. Cibler les interventions de pr√©vention
3. Informer les politiques de sant√© publique

## Objectifs de l'√©tude

### Objectif principal

Identifier et quantifier les facteurs de risque socio-d√©mographiques, p√©rinataux et socio-√©conomiques associ√©s √† une vuln√©rabilit√© accrue au TDAH chez les enfants tunisiens.

### Objectifs sp√©cifiques

1. D√©crire les caract√©ristiques de l'√©chantillon d'enfants tunisiens
2. Analyser la distribution des facteurs de risque dans la population
3. D√©velopper un score composite de risque th√©orique
4. Mod√©liser les associations entre facteurs de risque et score TDAH
5. Identifier les sous-populations √† haut risque

# M√©thodologie

## Source des donn√©es

### Enqu√™te MICS6 Tunisie 2023

L'enqu√™te √† Indicateurs Multiples (MICS6) est une enqu√™te nationale par grappes √† indicateurs multiples men√©e en Tunisie en 2023 par l'Institut National de la Statistique (INS) avec l'appui de l'UNICEF.

**Caract√©ristiques de l'enqu√™te** :

- Plan de sondage : √âchantillonnage stratifi√© √† deux degr√©s
- Unit√©s primaires : Aires de d√©nombrement (PSU)
- Repr√©sentativit√© : Nationale, urbain/rural, r√©gionale
- P√©riode de collecte : 2023

## Population d'√©tude

### Crit√®res d'inclusion
- Enfants √¢g√©s de 0 √† 17 ans
- Vivants au moment de l'enqu√™te
- Donn√©es compl√®tes sur les variables cl√©s

### Crit√®res d'exclusion
- Enfants d√©c√©d√©s
- Donn√©es manquantes sur les variables essentielles (√¢ge maternel, ordre de naissance, richesse)

### √âchantillon final

```{r taille-echantillon}
tibble(
  √âtape = c(
    "Enfants dans bh.sav",
    "Enfants vivants",
    "Avec donn√©es compl√®tes",
    "√âchantillon final"
  ),
  N = c(
    "~9,400",
    "~9,200",
    format(nrow(dataset_score), big.mark = " "),
    format(nrow(dataset_score), big.mark = " ")
  )
) %>%
  kable(caption = "Constitution de l'√©chantillon d'analyse") %>%
  kable_styling(bootstrap_options = c("striped", "hover"))
```

## Variables √©tudi√©es

### Variable d√©pendante : Score de risque TDAH

Un **score composite de risque th√©orique** a √©t√© d√©velopp√© en pond√©rant chaque facteur de risque selon l'importance rapport√©e dans la litt√©rature scientifique.

**Formule du score** :
$$
\text{Score TDAH} = \sum_{i=1}^{7} (w_i \times r_i) \times 100
$$

o√π $w_i$ est le poids du facteur $i$ et $r_i$ est la pr√©sence (1) ou absence (0) du facteur.

**Pond√©rations bas√©es sur la litt√©rature** :

```{r tableau-poids}
facteurs_info %>%
  mutate(
    Poids = paste0(round(Poids * 100, 0), "%"),
    Facteur = c(
      "√Çge maternel √† risque",
      "Rang de naissance √©lev√©",
      "Espacement court",
      "Pauvret√©",
      "Faible √©ducation maternelle",
      "Grande taille m√©nage",
      "Sexe masculin"
    )
  ) %>%
  select(Facteur, Poids, Reference, Description) %>%
  kable(
    caption = "Pond√©rations des facteurs de risque TDAH (litt√©rature)",
    col.names = c("Facteur", "Poids", "R√©f√©rence", "Description")
  ) %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = FALSE) %>%
  column_spec(1, bold = TRUE) %>%
  column_spec(2, bold = TRUE, color = "red")
```

**Cat√©gorisation du score** :

- Risque **faible** : Score < 20
- Risque **moyen** : 20 ‚â§ Score < 40
- Risque **√©lev√©** : Score ‚â• 40

### Variables ind√©pendantes

#### Facteurs p√©rinataux

1. **√Çge maternel √† la naissance**
   - Cat√©gories : < 20 ans, 20-34 ans, ‚â• 35 ans
   - Risque : < 20 ans OU ‚â• 35 ans

2. **Ordre de naissance**
   - Cat√©gories : Premier, 2-3, 4-6, ‚â• 7
   - Risque : Rang ‚â• 4

3. **Intervalle interg√©n√©sique**
   - Cat√©gories : Premier n√©, < 2 ans, 2 ans, 3 ans, ‚â• 4 ans
   - Risque : < 24 mois

#### Facteurs socio-√©conomiques

4. **Quintile de richesse**
   - Cat√©gories : Q1 (plus pauvre) √† Q5 (plus riche)
   - Risque : Q1 ou Q2

5. **√âducation maternelle**
   - Cat√©gories : Aucune, Primaire, Secondaire, Sup√©rieur
   - Risque : Aucune ou Primaire

6. **Milieu de r√©sidence**
   - Cat√©gories : Urbain, Rural
   - Risque : Rural

7. **Taille du m√©nage**
   - Mesure : Nombre de personnes
   - Risque : > 7 personnes

#### Facteur biologique

8. **Sexe de l'enfant**
   - Cat√©gories : Masculin, F√©minin
   - Risque : Masculin
   - **Note** : Variable disponible pour seulement ~3% de l'√©chantillon (limitation importante)

## Analyses statistiques

### Analyses descriptives

- Statistiques univari√©es (moyennes, proportions)
- Tableaux de contingence
- Visualisations (histogrammes, barplots)

### Analyses bivari√©es

- Tests du Chi-deux pour variables cat√©gorielles
- Tests t de Student et ANOVA pour comparaisons de moyennes
- Corr√©lations de Pearson entre facteurs de risque

### Analyses multivari√©es

#### R√©gression lin√©aire multiple

Mod√®le expliquant le score continu de risque TDAH :

$$
\text{Score TDAH} = \beta_0 + \sum_{i=1}^{p} \beta_i X_i + \epsilon
$$

#### R√©gression logistique

Mod√®le expliquant le risque TDAH √©lev√© (score ‚â• 40) :

$$
\text{logit}(P(\text{Risque √©lev√©})) = \beta_0 + \sum_{i=1}^{p} \beta_i X_i
$$

**M√©triques rapport√©es** :

- Odds Ratios (OR) avec intervalles de confiance √† 95%
- Valeurs p
- AIC pour comparaison des mod√®les
- Pseudo R¬≤ (McFadden)

### Logiciels utilis√©s

- **R version 4.x** 
- Packages : `tidyverse`, `haven`, `broom`, `car`, `gtsummary`

# R√©sultats

## Caract√©ristiques de l'√©chantillon

### Description g√©n√©rale

```{r tableau-descriptif}
desc_stats <- dataset_score %>%
  summarise(
    N = format(n(), big.mark = " "),
    `√Çge moyen (ann√©es)` = paste0(round(mean(age_annees, na.rm = TRUE), 1), " ¬± ", 
                                   round(sd(age_annees, na.rm = TRUE), 1)),
    `Milieu urbain (%)` = paste0(round(mean(milieu == "Urbain", na.rm = TRUE) * 100, 1), "%"),
    `Pauvret√© Q1-Q2 (%)` = paste0(round(mean(richesse_risque, na.rm = TRUE) * 100, 1), "%"),
    `Faible √©duc. m√®re (%)` = paste0(round(mean(educ_mere_risque, na.rm = TRUE) * 100, 1), "%"),
    `Taille m√©nage moyenne` = paste0(round(mean(taille_menage, na.rm = TRUE), 1), " ¬± ",
                                      round(sd(taille_menage, na.rm = TRUE), 1))
  ) %>%
  pivot_longer(everything(), names_to = "Caract√©ristique", values_to = "Valeur")

desc_stats %>%
  kable(caption = "Caract√©ristiques g√©n√©rales de l'√©chantillon") %>%
  kable_styling(bootstrap_options = c("striped", "hover"))
```

L'√©chantillon final comprend **`r format(nrow(dataset_score), big.mark=" ")` enfants** √¢g√©s de 0 √† 17 ans. L'√¢ge moyen est de `r round(mean(dataset_score$age_annees), 1)` ans. La population se r√©partit entre zones urbaines (`r round(mean(dataset_score$milieu == "Urbain") * 100, 1)`%) et rurales (`r 100 - round(mean(dataset_score$milieu == "Urbain") * 100, 1)`%).

### Distribution par groupe d'√¢ge

```{r graphique-age}
#| fig-cap: "R√©partition des enfants par groupe d'√¢ge"
#| code-fold: true

dataset_score %>%
  count(age_groupe) %>%
  mutate(pct = n / sum(n) * 100) %>%
  ggplot(aes(x = age_groupe, y = n, fill = age_groupe)) +
  geom_col(alpha = 0.8) +
  geom_text(aes(label = paste0(format(n, big.mark=" "), "\n(", round(pct, 1), "%)")),
            vjust = -0.3, fontface = "bold", size = 3.5) +
  scale_fill_brewer(palette = "Set2") +
  scale_y_continuous(expand = expansion(mult = c(0, 0.1))) +
  labs(
    title = "Distribution des enfants par groupe d'√¢ge",
    x = "Groupe d'√¢ge",
    y = "Nombre d'enfants"
  ) +
  theme_minimal(base_size = 13) +
  theme(
    legend.position = "none",
    plot.title = element_text(face = "bold"),
    axis.text.x = element_text(angle = 20, hjust = 1)
  )
```

### Caract√©ristiques socio-√©conomiques

```{r graphique-ses}
#| fig-cap: "Distribution des caract√©ristiques socio-√©conomiques"
#| fig-height: 8
#| code-fold: true

p1 <- dataset_score %>%
  count(richesse_cat) %>%
  mutate(pct = n / sum(n) * 100) %>%
  ggplot(aes(x = richesse_cat, y = pct, fill = richesse_cat)) +
  geom_col(alpha = 0.8) +
  geom_text(aes(label = paste0(round(pct, 1), "%")), 
            vjust = -0.5, fontface = "bold") +
  scale_fill_brewer(palette = "RdYlGn", direction = -1) +
  scale_y_continuous(expand = expansion(mult = c(0, 0.15))) +
  labs(title = "Quintile de richesse", x = NULL, y = "Pourcentage") +
  theme_minimal() +
  theme(legend.position = "none", axis.text.x = element_text(angle = 20, hjust = 1))

p2 <- dataset_score %>%
  count(educ_mere_cat) %>%
  mutate(pct = n / sum(n) * 100) %>%
  ggplot(aes(x = educ_mere_cat, y = pct, fill = educ_mere_cat)) +
  geom_col(alpha = 0.8) +
  geom_text(aes(label = paste0(round(pct, 1), "%")), 
            vjust = -0.5, fontface = "bold") +
  scale_fill_brewer(palette = "YlOrRd") +
  scale_y_continuous(expand = expansion(mult = c(0, 0.15))) +
  labs(title = "√âducation maternelle", x = NULL, y = "Pourcentage") +
  theme_minimal() +
  theme(legend.position = "none", axis.text.x = element_text(angle = 20, hjust = 1))

p3 <- dataset_score %>%
  count(milieu) %>%
  mutate(pct = n / sum(n) * 100) %>%
  ggplot(aes(x = milieu, y = pct, fill = milieu)) +
  geom_col(alpha = 0.8, width = 0.6) +
  geom_text(aes(label = paste0(format(n, big.mark=" "), "\n(", round(pct, 1), "%)")), 
            vjust = -0.3, fontface = "bold") +
  scale_fill_manual(values = c("Urbain" = "#3498db", "Rural" = "#27ae60")) +
  scale_y_continuous(expand = expansion(mult = c(0, 0.15))) +
  labs(title = "Milieu de r√©sidence", x = NULL, y = "Pourcentage") +
  theme_minimal() +
  theme(legend.position = "none")

(p1 + p2) / p3
```

## Pr√©valence des facteurs de risque

### Vue d'ensemble

```{r prevalence-facteurs}
#| fig-cap: "Pr√©valence des facteurs de risque TDAH dans la population"
#| fig-height: 7
#| code-fold: true

dataset_score %>%
  select(age_mere_risque, ordre_risque, intervalle_risque,
         richesse_risque, educ_mere_risque, milieu_risque,
         taille_menage_risque, sexe_risque) %>%
  summarise(across(everything(), ~sum(., na.rm = TRUE))) %>%
  pivot_longer(everything(), names_to = "Facteur", values_to = "N") %>%
  mutate(
    Pct = N / nrow(dataset_score) * 100,
    Facteur = factor(Facteur, 
                     levels = c("sexe_risque", "richesse_risque", "educ_mere_risque",
                               "milieu_risque", "age_mere_risque", "ordre_risque",
                               "intervalle_risque", "taille_menage_risque"),
                     labels = c("Sexe masculin*", "Pauvret√© (Q1-Q2)", 
                               "Faible √©duc. m√®re", "Milieu rural", 
                               "√Çge m√®re √† risque", "Rang ‚â•4",
                               "Espacement <24m", "M√©nage >7"))
  ) %>%
  ggplot(aes(x = reorder(Facteur, Pct), y = Pct)) +
  geom_col(aes(fill = Pct), alpha = 0.8) +
  geom_text(aes(label = paste0(round(Pct, 1), "%\n(n=", format(N, big.mark=" "), ")")), 
            hjust = -0.1, size = 3.5, fontface = "bold") +
  coord_flip() +
  scale_fill_gradient(low = "#ffa07a", high = "#dc143c") +
  scale_y_continuous(expand = expansion(mult = c(0, 0.15)), 
                     labels = percent_format(scale = 1)) +
  labs(
    title = "Pr√©valence des Facteurs de Risque TDAH",
    subtitle = paste0("N = ", format(nrow(dataset_score), big.mark=" "), " enfants | *Donn√©es limit√©es sur le sexe"),
    x = NULL,
    y = "Pourcentage d'enfants expos√©s"
  ) +
  theme_minimal(base_size = 12) +
  theme(
    legend.position = "none",
    plot.title = element_text(face = "bold", size = 14),
    panel.grid.major.y = element_blank()
  )
```

**Points cl√©s** :

- Le facteur le plus pr√©valent est le **milieu rural** (`r round(mean(dataset_score$milieu_risque) * 100, 1)`%)
- La **pauvret√©** (Q1-Q2) touche `r round(mean(dataset_score$richesse_risque) * 100, 1)`% des enfants
- `r round(mean(dataset_score$educ_mere_risque) * 100, 1)`% des m√®res ont un **faible niveau d'√©ducation**
- L'**√¢ge maternel √† risque** concerne `r round(mean(dataset_score$age_mere_risque) * 100, 1)`% des naissances

### Cumul des facteurs de risque

```{r cumul-risques}
#| fig-cap: "Distribution du nombre cumul√© de facteurs de risque"
#| code-fold: true

dataset_score %>%
  mutate(
    nb_risques_total = nb_risques_perinataux + nb_risques_socioeco + sexe_risque
  ) %>%
  count(nb_risques_total) %>%
  mutate(pct = n / sum(n) * 100) %>%
  ggplot(aes(x = nb_risques_total, y = n)) +
  geom_col(aes(fill = nb_risques_total), alpha = 0.8, width = 0.7) +
  geom_text(aes(label = paste0(format(n, big.mark=" "), "\n(", round(pct, 1), "%)")), 
            vjust = -0.5, size = 4, fontface = "bold") +
  scale_fill_gradient(low = "#90ee90", high = "#ff4500") +
  scale_x_continuous(breaks = 0:max(dataset_score$nb_risques_perinataux + dataset_score$nb_risques_socioeco + dataset_score$sexe_risque)) +
  scale_y_continuous(expand = expansion(mult = c(0, 0.15))) +
  labs(
    title = "Distribution du Nombre de Facteurs de Risque Cumul√©s",
    subtitle = "Risques p√©rinataux + socio-√©conomiques + sexe masculin",
    x = "Nombre de facteurs de risque",
    y = "Nombre d'enfants"
  ) +
  theme_minimal(base_size = 12) +
  theme(
    legend.position = "none",
    plot.title = element_text(face = "bold", size = 14)
  )
```

- **`r round(mean(dataset_score$nb_risques_perinataux + dataset_score$nb_risques_socioeco + dataset_score$sexe_risque, na.rm = TRUE), 2)` facteurs en moyenne** par enfant
- `r sum((dataset_score$nb_risques_perinataux + dataset_score$nb_risques_socioeco) >= 3)` enfants (`r round(mean((dataset_score$nb_risques_perinataux + dataset_score$nb_risques_socioeco) >= 3) * 100, 1)`%) cumulent **‚â• 3 facteurs de risque**

## Distribution du score de risque TDAH

### Score global

```{r stats-score}
resume_score_text <- dataset_score %>%
  summarise(
    Moyenne = round(mean(score_tdah), 1),
    M√©diane = round(median(score_tdah), 1),
    ET = round(sd(score_tdah), 1),
    Min = round(min(score_tdah), 1),
    Max = round(max(score_tdah), 1),
    Q1 = round(quantile(score_tdah, 0.25), 1),
    Q3 = round(quantile(score_tdah, 0.75), 1)
  )

kable(
  resume_score_text %>% pivot_longer(everything()),
  col.names = c("Statistique", "Valeur"),
  caption = "Statistiques descriptives du score de risque TDAH (0-100)"
) %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = FALSE)
```

```{r distrib-score}
#| fig-cap: "Distribution du score de risque th√©orique TDAH"
#| fig-height: 6
#| code-fold: true

ggplot(dataset_score, aes(x = score_tdah)) +
  geom_histogram(aes(y = after_stat(density)), 
                 bins = 30, fill = "steelblue", alpha = 0.7, color = "white") +
  geom_density(color = "darkred", linewidth = 1.5) +
  geom_vline(xintercept = c(20, 40), linetype = "dashed", 
             color = "darkred", linewidth = 1) +
  annotate("text", x = 10, y = 0.035, label = "Faible", 
           color = "darkgreen", size = 5, fontface = "bold") +
  annotate("text", x = 30, y = 0.035, label = "Moyen", 
           color = "orange", size = 5, fontface = "bold") +
  annotate("text", x = 55, y = 0.035, label = "√âlev√©", 
           color = "red", size = 5, fontface = "bold") +
  labs(
    title = "Distribution du Score de Risque Th√©orique TDAH",
    subtitle = paste0("N = ", format(nrow(dataset_score), big.mark=" "), " enfants | Moyenne = ",
                     round(mean(dataset_score$score_tdah), 1), " | ET = ",
                     round(sd(dataset_score$score_tdah), 1)),
    x = "Score de risque TDAH (0-100)",
    y = "Densit√©"
  ) +
  theme_minimal(base_size = 13) +
  theme(
    plot.title = element_text(face = "bold", size = 15),
    panel.grid.minor = element_blank()
  )
```

### R√©partition par cat√©gories de risque

```{r categories-risque}
#| fig-cap: "R√©partition des enfants par cat√©gorie de risque TDAH"
#| code-fold: true

dataset_score %>%
  count(risque_tdah_cat) %>%
  mutate(
    pct = n / sum(n) * 100,
    label = paste0(format(n, big.mark=" "), "\n(", round(pct, 1), "%)")
  ) %>%
  ggplot(aes(x = risque_tdah_cat, y = n, fill = risque_tdah_cat)) +
  geom_col(alpha = 0.85, width = 0.7) +
  geom_text(aes(label = label), vjust = -0.5, size = 5, fontface = "bold") +
  scale_fill_manual(values = c("Faible" = "#2ecc71",
                                "Moyen" = "#f39c12",
                                "√âlev√©" = "#e74c3c")) +
  labs(
    title = "R√©partition des Enfants par Cat√©gorie de Risque TDAH",
    x = "Cat√©gorie de risque",
    y = "Nombre d'enfants"
  ) +
  theme_minimal(base_size = 13) +
  theme(
    legend.position = "none",
    plot.title = element_text(face = "bold", size = 15),
    panel.grid.major.x = element_blank()
  ) +
  scale_y_continuous(expand = expansion(mult = c(0, 0.15)))
```

```{r tableau-categories}
distrib_cat %>%
  select(risque_tdah_cat, n, pct) %>%
  kable(
    col.names = c("Cat√©gorie", "Effectif", "Pourcentage"),
    caption = "Distribution des cat√©gories de risque TDAH",
    digits = 1
  ) %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = FALSE) %>%
  row_spec(3, bold = TRUE, color = "white", background = "#e74c3c")
```

**Pr√©valence du risque √©lev√©** : `r format(sum(dataset_score$risque_tdah_eleve), big.mark=" ")` enfants soit **`r round(mean(dataset_score$risque_tdah_eleve) * 100, 1)`%** de l'√©chantillon pr√©sentent un score de risque √©lev√© (‚â• 40).

### üìä Exploration Interactive de la Distribution

::: {.callout-tip}
## Visualisations Interactives

Les graphiques ci-dessous sont **ex√©cutables dans le navigateur**. Cliquez sur **"Run Code"** pour g√©n√©rer les visualisations avec des donn√©es d'exemple similaires √† notre √©tude.
:::

#### Distribution Interactive du Score

```{webr-r}
# Cr√©er des donn√©es d'exemple (similaires √† l'√©tude)
set.seed(123)
n <- 500

data_exemple <- data.frame(
  score_tdah = round(rnorm(n, mean = 25, sd = 12), 1)
)

# Histogramme avec densit√©
hist(data_exemple$score_tdah,
     breaks = 20,
     main = "Distribution du Score de Risque TDAH",
     xlab = "Score TDAH (0-100)",
     ylab = "Fr√©quence",
     col = "steelblue",
     border = "white",
     las = 1)

# Ajouter les seuils
abline(v = c(20, 40), col = c("orange", "red"), lty = 2, lwd = 2)

# L√©gende
legend("topright",
       legend = c("Faible (<20)", "Moyen (20-39)", "√âlev√© (‚â•40)"),
       col = c("darkgreen", "orange", "red"),
       lty = c(0, 2, 2), lwd = c(0, 2, 2),
       pch = c(15, NA, NA),
       col = c("steelblue", "orange", "red"),
       cex = 0.8)

# Statistiques
cat("\nüìä Statistiques descriptives:\n")
cat("Moyenne:", round(mean(data_exemple$score_tdah), 2), "\n")
cat("M√©diane:", round(median(data_exemple$score_tdah), 2), "\n")
cat("√âcart-type:", round(sd(data_exemple$score_tdah), 2), "\n")
cat("\nüìà R√©partition:\n")
cat("Risque Faible:", sum(data_exemple$score_tdah < 20), "enfants (",
    round(sum(data_exemple$score_tdah < 20)/n*100, 1), "%)\n")
cat("Risque Moyen:", sum(data_exemple$score_tdah >= 20 & data_exemple$score_tdah < 40),
    "enfants (", round(sum(data_exemple$score_tdah >= 20 & data_exemple$score_tdah < 40)/n*100, 1), "%)\n")
cat("Risque √âlev√©:", sum(data_exemple$score_tdah >= 40), "enfants (",
    round(sum(data_exemple$score_tdah >= 40)/n*100, 1), "%)\n")
```

#### Cat√©gories de Risque Interactive

```{webr-r}
# Calculer les cat√©gories
categories <- cut(data_exemple$score_tdah,
                  breaks = c(0, 20, 40, 100),
                  labels = c("Faible", "Moyen", "√âlev√©"))

# Compter
counts <- table(categories)
percentages <- prop.table(counts) * 100

# Barplot
barplot(counts,
        main = "R√©partition par Cat√©gorie de Risque",
        xlab = "Cat√©gorie",
        ylab = "Nombre d'Enfants",
        col = c("#2ecc71", "#f39c12", "#e74c3c"),
        border = "white",
        ylim = c(0, max(counts) * 1.2),
        las = 1)

# Ajouter les pourcentages
text(x = seq_along(counts) * 1.2 - 0.5,
     y = counts + 10,
     labels = paste0(round(percentages, 1), "%\n(n=", counts, ")"),
     pos = 3, cex = 1, font = 2)

# R√©sum√©
cat("\nüìä R√©sum√©:\n")
for(i in 1:length(counts)) {
  cat(names(counts)[i], ":", counts[i], "enfants (",
      round(percentages[i], 1), "%)\n")
}
```

### Score selon le milieu de r√©sidence

```{r score-milieu}
#| fig-cap: "Score TDAH selon le milieu de r√©sidence"
#| code-fold: true

ggplot(dataset_score, aes(x = milieu, y = score_tdah, fill = milieu)) +
  geom_violin(alpha = 0.6, trim = FALSE) +
  geom_boxplot(width = 0.2, alpha = 0.8) +
  stat_summary(fun = mean, geom = "point", shape = 23, size = 4, 
               fill = "red", color = "darkred") +
  scale_fill_manual(values = c("Urbain" = "#3498db", "Rural" = "#27ae60")) +
  labs(
    title = "Distribution du Score TDAH selon le Milieu",
    subtitle = "Diamant rouge = moyenne",
    x = "Milieu de r√©sidence",
    y = "Score de risque TDAH (0-100)"
  ) +
  theme_minimal(base_size = 13) +
  theme(
    legend.position = "none",
    plot.title = element_text(face = "bold")
  )
```

**Test t de Student** : 

- Score moyen urbain : `r round(t_milieu$estimate[2], 1)`
- Score moyen rural : `r round(t_milieu$estimate[1], 1)`
- Diff√©rence : `r round(abs(t_milieu$estimate[2] - t_milieu$estimate[1]), 1)` points
- t(`r round(t_milieu$parameter, 0)`) = `r round(abs(t_milieu$statistic), 2)`, p < 0.001

Le score de risque TDAH est significativement plus √©lev√© en milieu rural qu'en milieu urbain.

### Score selon la richesse

```{r score-richesse}
#| fig-cap: "Score TDAH selon le quintile de richesse"
#| fig-height: 7
#| code-fold: true

ggplot(dataset_score, aes(x = richesse_cat, y = score_tdah, fill = richesse_cat)) +
  geom_violin(alpha = 0.6, trim = FALSE) +
  geom_boxplot(width = 0.2, alpha = 0.8, outlier.alpha = 0.3) +
  stat_summary(fun = mean, geom = "point", shape = 23, size = 4, 
               fill = "red", color = "darkred") +
  scale_fill_brewer(palette = "RdYlGn", direction = -1) +
  labs(
    title = "Score TDAH selon le Quintile de Richesse",
    subtitle = "Diamant rouge = moyenne | Gradient socio-√©conomique √©vident",
    x = "Quintile de richesse",
    y = "Score de risque TDAH (0-100)"
  ) +
  theme_minimal(base_size = 13) +
  theme(
    legend.position = "none",
    plot.title = element_text(face = "bold", size = 15),
    axis.text.x = element_text(angle = 25, hjust = 1)
  )
```

On observe un **gradient socio-√©conomique net** : le score de risque diminue progressivement du quintile le plus pauvre (Q1) au quintile le plus riche (Q5).

## Analyses multivari√©es

### R√©gression logistique : Risque TDAH √©lev√©

Le tableau suivant pr√©sente les **Odds Ratios ajust√©s** du mod√®le complet pour pr√©dire un risque TDAH √©lev√© (score ‚â• 40).

```{r tableau-odds-ratios}
#| code-fold: true

or_final_present <- table_or_final %>%
  mutate(
    Variable = case_when(
      str_detect(Variable, "milieu|Rural") ~ "Milieu rural (vs Urbain)",
      str_detect(Variable, "richesse.*Q2") ~ "Richesse Q2 (vs Q5)",
      str_detect(Variable, "richesse.*Q3") ~ "Richesse Q3 (vs Q5)",
      str_detect(Variable, "richesse.*Q4") ~ "Richesse Q4 (vs Q5)",
      str_detect(Variable, "richesse.*Q1|pauvre") ~ "Richesse Q1 - Plus pauvre (vs Q5)",
      str_detect(Variable, "educ.*Aucune") ~ "Aucune √©ducation (vs Sup√©rieur)",
      str_detect(Variable, "educ.*Primaire") ~ "√âducation primaire (vs Sup√©rieur)",
      str_detect(Variable, "educ.*Secondaire") ~ "√âducation secondaire (vs Sup√©rieur)",
      str_detect(Variable, "age_mere.*20-34") ~ "√Çge m√®re 20-34 ans (vs <20)",
      str_detect(Variable, "age_mere.*35") ~ "√Çge m√®re ‚â• 35 ans (vs <20)",
      str_detect(Variable, "ordre.*Deuxi√®me") ~ "Rang 2-3 (vs Premier)",
      str_detect(Variable, "ordre.*Quatri√®me") ~ "Rang 4-6 (vs Premier)",
      str_detect(Variable, "ordre.*Septi√®me") ~ "Rang ‚â• 7 (vs Premier)",
      str_detect(Variable, "age_annees") ~ "√Çge enfant (ann√©es)",
      TRUE ~ Variable
    )
  )

kable(
  or_final_present,
  caption = "Odds Ratios ajust√©s - Mod√®le de r√©gression logistique complet",
  col.names = c("Variable", "OR [IC 95%]", "p-valeur", "Significatif"),
  align = c("l", "c", "c", "c")
) %>%
  kable_styling(bootstrap_options = c("striped", "hover")) %>%
  row_spec(which(or_final_present$Significatif == "Oui"), 
           bold = TRUE, background = "#fff3cd")
```

**Interpr√©tation des r√©sultats cl√©s** :

- Les enfants en **milieu rural**, en situation de **pauvret√©**, avec une **m√®re peu √©duqu√©e** et de **rang de naissance √©lev√©** pr√©sentent un risque TDAH significativement accru
- Un **gradient socio-√©conomique net** est observ√© pour la richesse et l'√©ducation maternelle
- L'**√¢ge maternel optimal** (20-34 ans) est fortement protecteur

### Qualit√© du mod√®le

```{r diagnostic-modele}
diagnostic_stats <- tibble(
  M√©trique = c(
    "Pseudo R¬≤ (McFadden)",
    "Sensibilit√©",
    "Sp√©cificit√©",
    "Pr√©cision globale"
  ),
  Valeur = c(
    round(pseudo_r2, 3),
    paste0(round(sensitivity * 100, 1), "%"),
    paste0(round(specificity * 100, 1), "%"),
    paste0(round(accuracy * 100, 1), "%")
  ),
  Interpr√©tation = c(
    paste0(round(pseudo_r2 * 100, 1), "% de variance expliqu√©e"),
    "Proportion de vrais positifs d√©tect√©s",
    "Proportion de vrais n√©gatifs d√©tect√©s",
    "Taux de classification correcte"
  )
)

kable(
  diagnostic_stats,
  caption = "M√©triques de qualit√© du mod√®le logistique"
) %>%
  kable_styling(bootstrap_options = c("striped", "hover"))
```

Le mod√®le pr√©sente une **excellente capacit√© pr√©dictive** avec un pseudo R¬≤ de `r round(pseudo_r2, 3)` et une pr√©cision globale de `r round(accuracy * 100, 1)`%.

## Profils √† haut risque

### Caract√©risation des enfants √† haut risque

Parmi les `r format(nrow(haut_risque), big.mark=" ")` enfants identifi√©s comme √©tant √† haut risque (score ‚â• 40), voici leur profil :

```{r profil-haut-risque}
profil_hr <- tibble(
  Caract√©ristique = c(
    "Effectif",
    "Pourcentage de l'√©chantillon",
    "Score TDAH moyen",
    "Milieu rural",
    "Pauvret√© (Q1-Q2)",
    "Faible √©ducation maternelle",
    "Rang de naissance ‚â• 4",
    "Taille m√©nage > 7"
  ),
  Valeur = c(
    format(nrow(haut_risque), big.mark = " "),
    paste0(round(nrow(haut_risque) / nrow(dataset_score) * 100, 1), "%"),
    round(mean(haut_risque$score_tdah), 1),
    paste0(round(mean(haut_risque$milieu == "Rural", na.rm = TRUE) * 100, 1), "%"),
    paste0(round(mean(haut_risque$richesse_risque, na.rm = TRUE) * 100, 1), "%"),
    paste0(round(mean(haut_risque$educ_mere_risque, na.rm = TRUE) * 100, 1), "%"),
    paste0(round(mean(haut_risque$ordre_risque, na.rm = TRUE) * 100, 1), "%"),
    paste0(round(mean(haut_risque$taille_menage_risque, na.rm = TRUE) * 100, 1), "%")
  )
)

kable(
  profil_hr,
  caption = "Profil des enfants √† haut risque TDAH (score ‚â• 40)"
) %>%
  kable_styling(bootstrap_options = c("striped", "hover")) %>%
  row_spec(1:2, bold = TRUE, background = "#f8d7da")
```

### Heatmap : Score moyen selon milieu et richesse

```{r heatmap-risque}
#| fig-cap: "Score TDAH moyen selon le milieu et le quintile de richesse"
#| code-fold: true

dataset_score %>%
  group_by(milieu, richesse_cat) %>%
  summarise(score_moyen = mean(score_tdah, na.rm = TRUE), 
            n = n(), .groups = "drop") %>%
  ggplot(aes(x = richesse_cat, y = milieu, fill = score_moyen)) +
  geom_tile(color = "white", linewidth = 1) +
  geom_text(aes(label = paste0(round(score_moyen, 1), "\n(n=", format(n, big.mark=" "), ")")), 
            color = "white", fontface = "bold", size = 4) +
  scale_fill_gradient2(low = "#2ecc71", mid = "#f39c12", high = "#e74c3c",
                       midpoint = 30, name = "Score\nmoyen") +
  labs(
    title = "Score TDAH Moyen : Interaction Milieu √ó Richesse",
    subtitle = "Les zones rurales pauvres concentrent le risque le plus √©lev√©",
    x = "Quintile de richesse",
    y = "Milieu de r√©sidence"
  ) +
  theme_minimal(base_size = 13) +
  theme(
    plot.title = element_text(face = "bold", size = 14),
    axis.text.x = element_text(angle = 25, hjust = 1),
    panel.grid = element_blank()
  )
```

**Point critique** : Les enfants vivant en **milieu rural ET dans les quintiles les plus pauvres** (Q1-Q2) pr√©sentent les scores de risque les plus √©lev√©s, mettant en √©vidence une **double p√©nalisation** (g√©ographique et √©conomique).

# Discussion

## Synth√®se des r√©sultats principaux

Cette √©tude, bas√©e sur les donn√©es repr√©sentatives de l'enqu√™te MICS6 Tunisie 2023, apporte plusieurs contributions majeures √† la compr√©hension des facteurs de risque du TDAH dans le contexte tunisien.

### 1. Pr√©valence du risque √©lev√©

Environ **`r round(mean(dataset_score$risque_tdah_eleve) * 100, 1)`%** des enfants tunisiens de 0 √† 17 ans pr√©sentent un score de risque th√©orique √©lev√© (‚â• 40), soit environ **`r format(nrow(haut_risque), big.mark=" ")` enfants** dans notre √©chantillon.

### 2. Gradient socio-√©conomique marqu√©

L'analyse r√©v√®le un **gradient socio-√©conomique tr√®s net** avec une diminution progressive du score de risque avec l'am√©lioration du statut socio-√©conomique.

### 3. Disparit√©s urbain-rural

Le milieu rural pr√©sente un **sur-risque significatif** avec une concentration des facteurs de risque cumul√©s.

### 4. Cumul des risques

Le cumul de facteurs de risque amplifie consid√©rablement la vuln√©rabilit√© avec un effet synergique entre pauvret√©, faible √©ducation et milieu rural.

## Limites de l'√©tude

### Limites m√©thodologiques

**1. Absence de diagnostic clinique**

La principale limite est l'**absence de mesure directe du TDAH**. Le score d√©velopp√© est un **proxy th√©orique** bas√© sur des facteurs de risque connus.

**2. Donn√©es limit√©es sur le sexe**

La variable "sexe" n'est disponible que pour environ 3% de l'√©chantillon, limitant les analyses par sexe.

**3. Design transversal**

Le design transversal ne permet pas d'√©tablir des relations causales.

## Implications pour la sant√© publique

### Implications pratiques

**1. D√©pistage et pr√©vention**

- Ciblage des populations vuln√©rables
- Strat√©gies de d√©pistage pr√©coce
- Pr√©vention primaire

**2. Politiques √©ducatives**

- Scolarisation des filles
- Programmes de soutien parental
- Interventions en milieu scolaire

**3. R√©duction des in√©galit√©s**

- Lutte contre la pauvret√©
- R√©duction du gradient urbain-rural
- √âquit√© territoriale

# Conclusion

Cette √©tude constitue **la premi√®re analyse populationnelle des facteurs de risque du TDAH en Tunisie** bas√©e sur des donn√©es nationales repr√©sentatives (MICS6 2023).

## Messages cl√©s

- **Environ `r round(mean(dataset_score$risque_tdah_eleve) * 100, 1)`% des enfants** pr√©sentent un profil de risque √©lev√©
- Le **gradient socio-√©conomique est tr√®s marqu√©**
- Le **milieu rural concentre les vuln√©rabilit√©s**
- Les **facteurs p√©rinataux restent importants**
- Le **cumul de facteurs amplifie le risque**

## Implications

**Pour la sant√© publique** : Cibler les interventions, d√©velopper des outils de d√©pistage, r√©duire les in√©galit√©s

**Pour les politiques publiques** : Investir dans l'√©ducation, renforcer les services de sant√© mentale, am√©liorer l'acc√®s aux soins ruraux

**Pour la recherche** : Valider le score, √©tudes longitudinales, √©valuation des interventions

---

**Citation sugg√©r√©e** : Belkahla, A. (2025). Facteurs de risque du TDAH chez les enfants tunisiens : Analyse des donn√©es MICS6 Tunisie 2023. [Rapport de recherche].

---

*Fin du rapport - G√©n√©r√© le `r Sys.Date()`*
